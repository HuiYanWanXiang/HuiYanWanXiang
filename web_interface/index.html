<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ç»˜æ¼”ä¸‡è±¡ | æ ¸å¿ƒæ§åˆ¶å°</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <style>
        .settings-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            border: 1px dashed var(--border-color);
            margin-bottom: 20px;
        }
        .settings-row { margin-bottom: 10px; }
        .settings-row label { display: block; color: #888; font-size: 11px; margin-bottom: 4px; }
        .settings-row select, .settings-row input {
            width: 100%;
            background: #222;
            border: 1px solid #444;
            color: var(--accent-color);
            padding: 5px;
            border-radius: 4px;
            font-size: 12px;
            outline: none;
        }
    </style>
</head>

<!-- å¸®åŠ©å¼¹çª— -->
<div id="helpModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:9999;">
    <div style="width:70%; max-width:800px; margin:50px auto; background:#1e1e1e; border:1px solid #00f3ff; border-radius:10px; padding:30px; color:#ddd; font-family:'Microsoft YaHei'; overflow-y:auto; max-height:80vh;">
        <h2 style="color:#00f3ff; border-bottom:1px solid #333; padding-bottom:10px;">ç»˜æ¼”ä¸‡è±¡ç”¨æˆ·æ“ä½œæ‰‹å†Œ V1.0</h2>

        <h3 style="color:#fff; margin-top:20px;">1. ç³»ç»Ÿç®€ä»‹</h3>
        <p style="line-height:1.6; font-size:14px; color:#aaa;">
            æœ¬ç³»ç»Ÿæ˜¯ä¸€æ¬¾åŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„Webç«¯äº¤äº’å¼ç‰©ç†ä»¿çœŸå®éªŒå¹³å°ã€‚æ—¨åœ¨é€šè¿‡è‡ªç„¶è¯­è¨€æŒ‡ä»¤ï¼Œå¿«é€Ÿç”Ÿæˆå…·å¤‡ä¸“ä¸šçº§UIã€å®æ—¶ç‰©ç†å¼•æ“æ¸²æŸ“åŠæ•°å­¦å…¬å¼æ¨å¯¼çš„æ•™å­¦è¯¾ä»¶ã€‚
        </p>

        <h3 style="color:#fff; margin-top:20px;">2. å¿«é€Ÿå…¥é—¨</h3>
        <ul style="line-height:1.8; font-size:14px; color:#aaa; padding-left:20px;">
            <li><strong>æ­¥éª¤ä¸€ï¼šé…ç½®å¼•æ“</strong> - é€‰æ‹©æ¨¡å‹å‚å•†ï¼ˆDeepSeek/Kimiç­‰ï¼‰ï¼Œå¹¶å¡«å…¥æœ‰æ•ˆçš„ API Keyã€‚</li>
            <li><strong>æ­¥éª¤äºŒï¼šè¾“å…¥æŒ‡ä»¤</strong> - åœ¨ Prompt è¾“å…¥æ¡†ä¸­æè¿°æ‚¨æƒ³è¦çš„ç‰©ç†åœºæ™¯ã€‚</li>
            <li><strong>æ­¥éª¤ä¸‰ï¼šå¯åŠ¨ç”Ÿæˆ</strong> - ç‚¹å‡»â€œğŸš€ å¯åŠ¨ç”Ÿæˆâ€ç”Ÿæˆäº¤äº’ç½‘é¡µã€‚</li>
            <li><strong>æ­¥éª¤å››ï¼šç”Ÿæˆè§†é¢‘</strong> - ç‚¹å‡»â€œğŸ¬ ç”Ÿæˆè§†é¢‘â€ç”Ÿæˆ Manim è®²è§£è§†é¢‘ã€‚</li>
            <li><strong>æ­¥éª¤äº”ï¼šæºç è°ƒè¯•</strong> - ç‚¹å‡»â€œâš¡ æ‰‹åŠ¨è¿è¡Œâ€è¿›å…¥å¼€å‘è€…æ¨¡å¼ï¼Œå¯ç›´æ¥ä¿®æ”¹ HTML/JS ä»£ç å¹¶çƒ­æ›´æ–°ã€‚</li>
        </ul>

        <h3 style="color:#fff; margin-top:20px;">3. å¸¸è§é—®é¢˜ (FAQ)</h3>
        <div style="background:#222; padding:10px; border-radius:4px; margin-top:10px;">
            <p style="color:#00f3ff; font-size:13px; font-weight:bold;">Q: ä¸ºä»€ä¹ˆç‚¹å‡»ç”Ÿæˆåæ²¡æœ‰ååº”ï¼Ÿ</p>
            <p style="color:#888; font-size:13px;">A: è¯·æ£€æŸ¥ API Key æ˜¯å¦æ­£ç¡®å¡«å†™ï¼Œä»¥åŠç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸ã€‚</p>
        </div>

        <button onclick="document.getElementById('helpModal').style.display='none'"
                style="margin-top:20px; width:100%; background:#333; border:none; padding:15px; color:#fff; cursor:pointer;">
            å…³é—­çª—å£ [CLOSE]
        </button>
    </div>
</div>

<!-- å³ä¸‹è§’ ? -->
<div style="position:fixed; bottom:20px; right:20px; width:40px; height:40px; background:#333; border-radius:50%;
            text-align:center; line-height:40px; cursor:pointer; border:1px solid #555; z-index:1000;"
     onclick="document.getElementById('helpModal').style.display='block'">
    <span style="color:#fff; font-weight:bold;">?</span>
</div>

<body>
    <div class="sidebar">
        <h2>ç»˜æ¼”ä¸‡è±¡ <span style="font-size:12px; opacity:0.6;">PRO</span></h2>

        <span class="label">âš™ï¸ å¼•æ“é…ç½® (ENGINE CONFIG)</span>
        <div class="settings-box">
            <div class="settings-row">
                <label>é€‰æ‹©æ¨¡å‹å‚å•† (Provider)</label>
                <select id="providerSelect" onchange="updateModelConfig()">
                    <option value="deepseek">DeepSeek (æ·±åº¦æ±‚ç´¢)</option>
                    <option value="openai">OpenAI</option>
                    <option value="moonshot">Kimi (æœˆä¹‹æš—é¢)</option>
                    <option value="aliyun">é€šä¹‰åƒé—® (é˜¿é‡Œäº‘)</option>
                    <option value="custom">è‡ªå®šä¹‰ (Custom)</option>
                </select>
            </div>

            <div class="settings-row">
                <label>API Key (å¯†é’¥)</label>
                <input type="password" id="apiKeyInput" placeholder="sk-xxxxxxxx..." value="">
            </div>

            <div class="settings-row" id="customUrlRow" style="display:none;">
                <label>Base URL</label>
                <input type="text" id="baseUrlInput" value="https://api.deepseek.com">
            </div>

            <div class="settings-row" id="customModelRow" style="display:none;">
                <label>Model Name</label>
                <input type="text" id="modelNameInput" value="deepseek-coder">
            </div>
        </div>

        <span class="label">æŒ‡ä»¤è¾“å…¥ (PROMPT)</span>
        <textarea id="userPrompt" placeholder="> ä¾‹å¦‚ï¼šç”Ÿæˆä¸€ä¸ªå—è¿«æŒ¯åŠ¨æ¼”ç¤º..."></textarea>

        <div class="btn-group">
            <button class="primary" id="generateBtn" onclick="generatePage()">ğŸš€ å¯åŠ¨ç”Ÿæˆ</button>
            <button class="secondary" id="generateVideoBtn" onclick="generateVideo()">ğŸ¬ ç”Ÿæˆè§†é¢‘</button>
            <button onclick="applyCode()">âš¡ æ‰‹åŠ¨è¿è¡Œ</button>
        </div>

        <div class="code-panel">
            <span class="label">æºç ç¼–è¾‘å™¨</span>
            <textarea id="codeEditor" placeholder="// ç­‰å¾…ç”Ÿæˆ..." spellcheck="false"></textarea>
        </div>
    </div>

    <div class="preview-area">
        <div class="status-bar" id="statusText"><span class="blink"></span>WAITING FOR CONFIG...</div>

        <div class="iframe-container">
            <!-- âœ… å…³é”®ï¼šé»˜è®¤æš—è‰² srcdoc å ä½é¡µï¼Œå½»åº•æ¶ˆç­ç™½å± -->
            <iframe id="previewFrame"
                    srcdoc='<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  :root{
    --bg:#0b0f14;
    --panel: rgba(0,0,0,0.45);
    --border: rgba(0,243,255,0.18);
    --accent:#00f3ff;
    --text: rgba(127,231,255,0.92);
    --muted: rgba(160,220,235,0.55);
  }
  html,body{
    margin:0; height:100%;
    background: radial-gradient(900px 420px at 50% 35%, rgba(0,243,255,0.10), rgba(0,0,0,0.85)),
                linear-gradient(180deg, rgba(10,12,18,0.98), rgba(0,0,0,0.98));
    font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Microsoft YaHei, Arial, sans-serif;
    color: var(--text);
  }
  .wrap{ height:100%; display:flex; align-items:center; justify-content:center; padding:24px; box-sizing:border-box; }
  .card{
    width:min(760px, 92vw);
    border:1px solid var(--border);
    border-radius:14px;
    background: var(--panel);
    box-shadow: 0 0 0 1px rgba(0,243,255,0.06) inset, 0 18px 50px rgba(0,0,0,0.55);
    padding:22px 22px 18px;
  }
  .title{ display:flex; align-items:center; gap:10px; letter-spacing:1px; font-weight:700; color: var(--accent); }
  .dot{
    width:10px; height:10px; border-radius:50%;
    background: var(--accent);
    box-shadow: 0 0 16px rgba(0,243,255,0.65);
    animation: pulse 1.4s ease-in-out infinite;
  }
  @keyframes pulse{ 0%,100%{ transform:scale(1); opacity:1; } 50%{ transform:scale(0.55); opacity:0.2; } }
  .hint{ margin-top:10px; line-height:1.7; color: var(--muted); font-size: 13px; }
  .steps{
    margin-top:14px;
    border-top:1px dashed rgba(0,243,255,0.18);
    padding-top:12px;
    display:grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap:10px;
    font-size:12px;
    color: rgba(160,220,235,0.68);
  }
  .pill{ border:1px solid rgba(0,243,255,0.14); border-radius:999px; padding:8px 10px; background: rgba(0,0,0,0.25); }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="title"><span class="dot"></span><span>WAITING FOR CONFIGâ€¦</span></div>
      <div class="hint">
        å³ä¾§é¢„è§ˆåŒºå·²å°±ç»ªã€‚è¯·åœ¨å·¦ä¾§å®Œæˆå¼•æ“é…ç½®ï¼ˆProvider + API Keyï¼‰ï¼Œè¾“å…¥ Promptï¼Œ
        ç‚¹å‡» <b>ğŸš€ å¯åŠ¨ç”Ÿæˆ</b> ç”Ÿæˆäº¤äº’ç½‘é¡µï¼›æˆ–ç‚¹å‡» <b>ğŸ¬ ç”Ÿæˆè§†é¢‘</b> ç”Ÿæˆ Manim è®²è§£è§†é¢‘ã€‚
      </div>
      <div class="steps">
        <div class="pill">â‘  é…ç½® Provider / Key</div>
        <div class="pill">â‘¡ è¾“å…¥ Prompt</div>
        <div class="pill">â‘¢ ç‚¹å‡»ç”ŸæˆæŒ‰é’®</div>
      </div>
    </div>
  </div>
</body>
</html>'>
            </iframe>
        </div>

        <!-- âœ… Manim è§†é¢‘é¢æ¿ -->
        <div id="videoPanel" style="padding: 12px 14px;">
            <div style="display:flex; align-items:center; gap:12px; margin-bottom:8px;">
                <span style="color:#00f3ff; font-weight:600; letter-spacing:0.5px;">MANIM VIDEO</span>
                <a id="videoOpenLink"
                   href="#"
                   target="_blank"
                   style="display:none; color:#7fe7ff; text-decoration:none; font-size:12px;">
                   æ‰“å¼€è§†é¢‘æ–‡ä»¶
                </a>
            </div>

            <video id="videoPlayer"
                   controls
                   style="width:100%; max-height:360px; background:#000; border-radius:10px;
                          border:1px solid rgba(0,243,255,0.25);">
            </video>

            <pre id="videoStatus"
                 style="margin-top:10px; padding:10px; background:rgba(0,0,0,0.35); color:#7fe7ff;
                        border-radius:10px; border:1px dashed rgba(0,243,255,0.25);
                        white-space:pre-wrap; font-size:12px; line-height:1.35;">
ç­‰å¾…ç”Ÿæˆè§†é¢‘...
            </pre>
        </div>

    </div>

    <script src="/static/js/app.js"></script>
    <script>
        // ç®€å•çš„é…ç½®åˆ‡æ¢é€»è¾‘
        function updateModelConfig() {
            const provider = document.getElementById('providerSelect').value;
            const urlRow = document.getElementById('customUrlRow');
            const modelRow = document.getElementById('customModelRow');
            const urlInput = document.getElementById('baseUrlInput');
            const modelInput = document.getElementById('modelNameInput');

            if (provider === 'custom') {
                urlRow.style.display = 'block';
                modelRow.style.display = 'block';
            } else {
                urlRow.style.display = 'none';
                modelRow.style.display = 'none';
                // é¢„è®¾å‚æ•°
                if (provider === 'deepseek') {
                    urlInput.value = "https://api.deepseek.com";
                    modelInput.value = "deepseek-coder";
                } else if (provider === 'openai') {
                    urlInput.value = "https://api.openai.com/v1";
                    modelInput.value = "gpt-4o-mini";
                } else if (provider === 'moonshot') {
                    urlInput.value = "https://api.moonshot.cn/v1";
                    modelInput.value = "moonshot-v1-8k";
                } else if (provider === 'aliyun') {
                    urlInput.value = "https://dashscope.aliyuncs.com/compatible-mode/v1";
                    modelInput.value = "qwen-plus";
                }
            }
        }
        updateModelConfig();
    </script>
</body>
</html>
